\hypertarget{_c_a_nopen__driver_8h_source}{}\doxysection{C\+A\+Nopen\+\_\+driver.\+h}
\label{_c_a_nopen__driver_8h_source}\index{CANopen\_driver.h@{CANopen\_driver.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#ifndef \_CANOPEN\_DRIVER\_H\_}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#define \_CANOPEN\_DRIVER\_H\_}}
\DoxyCodeLine{00003 }
\DoxyCodeLine{00011 \textcolor{preprocessor}{\#include "\mbox{\hyperlink{_c_a_nopen__socket_8h}{CANopen\_socket.h}}"}}
\DoxyCodeLine{00012 \textcolor{preprocessor}{\#include "\mbox{\hyperlink{parameter_8h}{parameter.h}}"}}
\DoxyCodeLine{00013 }
\DoxyCodeLine{00014 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{00015 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{00016 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{00017 \textcolor{preprocessor}{\#include <mutex>}}
\DoxyCodeLine{00018 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{00019 \textcolor{preprocessor}{\#include <thread>}}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021 \textcolor{keyword}{namespace }CANopen \{}
\DoxyCodeLine{00022 \textcolor{keywordtype}{void}}
\DoxyCodeLine{00023 print\_status(Parameter *);}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00027}\mbox{\hyperlink{class_c_a_nopen_1_1_driver}{00027}} \textcolor{keyword}{class }\mbox{\hyperlink{class_c_a_nopen_1_1_driver}{Driver}} \{}
\DoxyCodeLine{00028 }
\DoxyCodeLine{00029     \textcolor{keyword}{static} constexpr \textcolor{keywordtype}{int} NB\_PDO = 4;}
\DoxyCodeLine{00030     \textcolor{keyword}{static} constexpr \textcolor{keywordtype}{int} MAX\_PDO\_SLOT = 2;}
\DoxyCodeLine{00031 }
\DoxyCodeLine{00032     \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00034}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7}{00034}}     \textcolor{keyword}{enum} \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7}{Register}} : uint32\_t \{}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00035}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7ad4d184bb0cd942f6bdd5ae4435ba1469}{00035}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7ad4d184bb0cd942f6bdd5ae4435ba1469}{\_DCOMstatus}} = 0x60410000,   }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00039}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a41294d34718a36687c2183a45ef06258}{00039}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a41294d34718a36687c2183a45ef06258}{DCOMcontrol}} = 0x60400000,   }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00043}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a838ff7614cdd25d687a7b44f6fcd5112}{00043}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a838ff7614cdd25d687a7b44f6fcd5112}{DCOMopmode}} = 0x60600000,    }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00044}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a27c60a5c7499691fa7a8927c3d4e4376}{00044}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a27c60a5c7499691fa7a8927c3d4e4376}{\_DCOMopmd\_act}} = 0x60610000, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00046}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a9388c18e3ec79d918b872aab89a47387}{00046}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a9388c18e3ec79d918b872aab89a47387}{PPp\_target}} = 0x607A0000,    }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00051}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a97069ba1c67700d01ba84c05f2a31adb}{00051}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a97069ba1c67700d01ba84c05f2a31adb}{PPv\_target}} = 0x60810000,    }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00054}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a9a00b3971b7ee9985f91dd48ea7e1c73}{00054}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a9a00b3971b7ee9985f91dd48ea7e1c73}{PVv\_target}} = 0x60FF0000,    }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00055}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a68422e03c559dee45c67d4743784c193}{00055}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a68422e03c559dee45c67d4743784c193}{PTtq\_target}} = 0x60710000,   }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00057}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7ae34a009131bb4956dbb9a5c9e76b1c5a}{00057}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7ae34a009131bb4956dbb9a5c9e76b1c5a}{RAMP\_v\_acc}} = 0x60830000,    }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00059}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a6f355b7bef6158931cc8cf5e4b1f9c83}{00059}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a6f355b7bef6158931cc8cf5e4b1f9c83}{RAMP\_v\_dec}} = 0x60840000,    }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00061}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7af361a27c780c9ab4fe29763c80456258}{00061}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7af361a27c780c9ab4fe29763c80456258}{\_p\_act}} = 0x60640000,        }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00062}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a5790a9abb07781ba9d63ed64d7e0d7fc}{00062}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a5790a9abb07781ba9d63ed64d7e0d7fc}{\_v\_act}} = 0x606C0000,        }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00064}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a0ab750decb5de6f5b2d380776dec09cc}{00064}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a0ab750decb5de6f5b2d380776dec09cc}{\_tq\_act}} = 0x60770000,       }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00066}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a503823e06d7db891f898f6976aa7a514}{00066}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a503823e06d7db891f898f6976aa7a514}{HMmethod}} = 0x60980000,      }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00067}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7ad34e94f677df757d01d787a403a66a2a}{00067}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7ad34e94f677df757d01d787a403a66a2a}{HMv}} = 0x60990001,           }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00068}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a796f4544102d3244ab451b229afbfb58}{00068}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a796f4544102d3244ab451b229afbfb58}{HMv\_out}} = 0x60990002        }
\DoxyCodeLine{00069     \};}
\DoxyCodeLine{00070 }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00072}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3ceb}{00072}}     \textcolor{keyword}{enum} \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3ceb}{OperationMode}} : int8\_t \{}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00073}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3ceba3502834b10b8f0201a628b9a0e227425}{00073}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3ceba3502834b10b8f0201a628b9a0e227425}{ProfilePosition}} = 1,      }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00075}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3cebacaf4b433be6b0476e7f157e086fea379}{00075}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3cebacaf4b433be6b0476e7f157e086fea379}{Velocity}} = 2,             }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00077}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3cebadb9f0017145112261254a48699a41961}{00077}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3cebadb9f0017145112261254a48699a41961}{ProfileVelocity}} = 3,      }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00079}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3cebaff42df87ec625334500bb240f76989ed}{00079}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3cebaff42df87ec625334500bb240f76989ed}{ProfileTorque}} = 4,        }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00083}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3ceba080efe911eeba1ae575bfaa70b1bb579}{00083}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3ceba080efe911eeba1ae575bfaa70b1bb579}{Homing}} = 6,               }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00084}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3cebab11858fe79ae30e3723a3cdb66360287}{00084}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3cebab11858fe79ae30e3723a3cdb66360287}{InterpolatedPosition}} = 7, }
\DoxyCodeLine{00088     \};}
\DoxyCodeLine{00089 }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00091}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02d}{00091}}     \textcolor{keyword}{enum} \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02d}{State}} : uint16\_t \{}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00092}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dac8ab6913526ea2fc62be30139261fbc6}{00092}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dac8ab6913526ea2fc62be30139261fbc6}{mask}} = 0x006f,                }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00093}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da94d00ab583965d1d22f48674f7aefa7a}{00093}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da94d00ab583965d1d22f48674f7aefa7a}{NotReadyToSwitchtON}} = 0x0000, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00099}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da52c43c11131a9d753319d5e065d031c3}{00099}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da52c43c11131a9d753319d5e065d031c3}{SwitchONDisabled}} = 0x0040, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00106}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dafa947edce547a30b314910e6931235a4}{00106}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dafa947edce547a30b314910e6931235a4}{ReadyToSwitchON}} = 0x0021, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00111}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dac2e13098b6500cdcde217d2a9cc9ebb6}{00111}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dac2e13098b6500cdcde217d2a9cc9ebb6}{SwitchedON}} = 0x0023, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00117}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da1692c431e1cf20446dbf23a53913af0c}{00117}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da1692c431e1cf20446dbf23a53913af0c}{OperationEnabled}} = 0x0037, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00122}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da9028b5332c8352a087606c2cc79e9517}{00122}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da9028b5332c8352a087606c2cc79e9517}{Fault}} = 0x000f, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00127}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dabafb33b6c4f43661a3257ca5b7569372}{00127}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dabafb33b6c4f43661a3257ca5b7569372}{FaultReactionActive}} = 0x000f, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00133}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da8accb6a0a36eebcd88f85e0b92faf68a}{00133}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02da8accb6a0a36eebcd88f85e0b92faf68a}{QuickStopActive}} = 0x0007 }
\DoxyCodeLine{00139     \};}
\DoxyCodeLine{00140     \textcolor{keyword}{enum} StatusBits : uint16\_t \{}
\DoxyCodeLine{00141         ReadyToSwitchOn\_bit = 0x0001,}
\DoxyCodeLine{00142         SwitchedOn\_bit = 0x0002,}
\DoxyCodeLine{00143         OperationEnabled\_bit = 0x0004,}
\DoxyCodeLine{00144         Fault\_bit = 0x0008,}
\DoxyCodeLine{00145         VoltageEnabled\_bit = 0x0010,}
\DoxyCodeLine{00146         QuickStop\_bit = 0x0020,}
\DoxyCodeLine{00147         SwitchONDisabled\_bit = 0x0040,}
\DoxyCodeLine{00148         Error0\_bit = 0x0080,}
\DoxyCodeLine{00149         HaltRequest\_bit = 0x0100,}
\DoxyCodeLine{00150         Remote\_bit = 0x0200,}
\DoxyCodeLine{00151         TargetReached\_bit = 0x0400,}
\DoxyCodeLine{00152         InternalLimitReached\_bit = 0x0800,}
\DoxyCodeLine{00153         OperationMode\_bit = 0x1000,}
\DoxyCodeLine{00154         BlockingError\_bit = 0x2000,}
\DoxyCodeLine{00155         OperationModeStart\_bit = 0x4000,}
\DoxyCodeLine{00156         ValidRef\_bit = 0x8000}
\DoxyCodeLine{00157     \};}
\DoxyCodeLine{00158 }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00160}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903a}{00160}}     \textcolor{keyword}{enum} \mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903a}{Control}} : uint16\_t \{}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00161}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aa6ccc4c2738c634abe2fd21cbe93f9fdb}{00161}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aa6ccc4c2738c634abe2fd21cbe93f9fdb}{Shutdown}} = 0x0006,         }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00162}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aae98ed55dcd60bdd15d179ec32f651b8d}{00162}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aae98ed55dcd60bdd15d179ec32f651b8d}{SwitchON}} = 0x0007,         }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00163}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aa81c0fb39e9e145721e1cf45a52f8786f}{00163}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aa81c0fb39e9e145721e1cf45a52f8786f}{DisableVoltage}} = 0x0000,   }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00164}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aa6e8fc43d0b5f1ef14ac7ba475572c9b6}{00164}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aa6e8fc43d0b5f1ef14ac7ba475572c9b6}{QuickStop}} = 0x0002,        }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00165}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aaa366dac5dbc508501f36112bf5472572}{00165}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aaa366dac5dbc508501f36112bf5472572}{DisableOperation}} = 0x0007, }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00166}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aaff77b9045071e916120fc49e159d2f77}{00166}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aaff77b9045071e916120fc49e159d2f77}{EnableOperation}} = 0x000f,  }
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00167}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aaa433113dfe71a54d4333344a339a9bbf}{00167}}         \mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903aaa433113dfe71a54d4333344a339a9bbf}{FaultResest}} = 0x0080       }
\DoxyCodeLine{00168     \};}
\DoxyCodeLine{00169 }
\DoxyCodeLine{00170     \textcolor{keyword}{enum} PDOFunctionCode : uint32\_t \{}
\DoxyCodeLine{00171         PDO1Transmit = \mbox{\hyperlink{class_c_a_nopen_1_1_message_a0f8f95e4ea1284011cd122629edc5468aea8753e3c4fecde547db28a4a01f4fea}{Message::PDO1Transmit}},}
\DoxyCodeLine{00172         PDO1Receive = \mbox{\hyperlink{class_c_a_nopen_1_1_message_a0f8f95e4ea1284011cd122629edc5468a289816747eb21454c97a2c0de54bd7bd}{Message::PDO1Receive}},}
\DoxyCodeLine{00173         PDO2Transmit = \mbox{\hyperlink{class_c_a_nopen_1_1_message_a0f8f95e4ea1284011cd122629edc5468a644cdb60cf2ec10f6f509c6dac09c7e7}{Message::PDO2Transmit}},}
\DoxyCodeLine{00174         PDO2Receive = \mbox{\hyperlink{class_c_a_nopen_1_1_message_a0f8f95e4ea1284011cd122629edc5468ae19e8c5160acfaab1c140c21789138e3}{Message::PDO2Receive}},}
\DoxyCodeLine{00175         PDO3Transmit = \mbox{\hyperlink{class_c_a_nopen_1_1_message_a0f8f95e4ea1284011cd122629edc5468ac15c2cbe07eac4f1fdc102927deadcdc}{Message::PDO3Transmit}},}
\DoxyCodeLine{00176         PDO3Receive = \mbox{\hyperlink{class_c_a_nopen_1_1_message_a0f8f95e4ea1284011cd122629edc5468ab059d1f4ab6ed9bb993e5d37aea6eba1}{Message::PDO3Receive}},}
\DoxyCodeLine{00177         PDO4Transmit = \mbox{\hyperlink{class_c_a_nopen_1_1_message_a0f8f95e4ea1284011cd122629edc5468a46d53ca55e462afcab565303b212656c}{Message::PDO4Transmit}},}
\DoxyCodeLine{00178         PDO4Receive = \mbox{\hyperlink{class_c_a_nopen_1_1_message_a0f8f95e4ea1284011cd122629edc5468a45f4fc29142533ab1395bd971c12be9b}{Message::PDO4Receive}},}
\DoxyCodeLine{00179     \};}
\DoxyCodeLine{00180 }
\DoxyCodeLine{00187     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a0272315f94cb7bff729abeb8b8b052df}{Driver}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *ifname, uint16\_t can\_id, \textcolor{keywordtype}{int} verbose\_lvl = 0);}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00196     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{00197     \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00198}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a0da074f8cf3498e5d1c721ceaaa81a6e}{00198}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a0da074f8cf3498e5d1c721ceaaa81a6e}{set}}(\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7}{Register}} reg, T val, \textcolor{keywordtype}{bool} force\_sdo = \textcolor{keyword}{false}, \textcolor{keywordtype}{bool} wait = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{00199 }
\DoxyCodeLine{00200         \textcolor{keywordflow}{if}(m\_available) \{}
\DoxyCodeLine{00201             m\_parameters[reg]-\/>set(val);}
\DoxyCodeLine{00202             \textcolor{keywordflow}{if}(m\_parameters[reg]-\/>pdo\_slot == -\/1 || force\_sdo || wait)}
\DoxyCodeLine{00203                 \mbox{\hyperlink{class_c_a_nopen_1_1_driver_ad22705c4ee8cfee391113d359e790e67}{send}}(m\_parameters[reg]);}
\DoxyCodeLine{00204             \textcolor{keywordflow}{if}(wait)}
\DoxyCodeLine{00205                 \textcolor{keywordflow}{while}(m\_parameters[reg]-\/>sdo\_flag.test\_and\_set())}
\DoxyCodeLine{00206                     ;}
\DoxyCodeLine{00207         \}}
\DoxyCodeLine{00208     \}}
\DoxyCodeLine{00209 }
\DoxyCodeLine{00216     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{00217     T}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00218}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_ae34094765084838267ac2ec088cf6554}{00218}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_ae34094765084838267ac2ec088cf6554}{get}}(\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7}{Register}} reg, \textcolor{keywordtype}{bool} force\_sdo = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{00219 }
\DoxyCodeLine{00220         \textcolor{keywordflow}{if}(force\_sdo \&\& m\_available) \{}
\DoxyCodeLine{00221             \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a96123f2965334f4fda9c01ae7b0f8f46}{update}}(m\_parameters[reg]);}
\DoxyCodeLine{00222             \textcolor{keywordflow}{while}(m\_parameters[reg]-\/>sdo\_flag.test\_and\_set())}
\DoxyCodeLine{00223                 ;}
\DoxyCodeLine{00224         \}}
\DoxyCodeLine{00225         \textcolor{keywordflow}{return} m\_parameters[reg]-\/>get<T>();}
\DoxyCodeLine{00226     \};}
\DoxyCodeLine{00227 }
\DoxyCodeLine{00232     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00233     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_aa831bccff07ba4c794952c8477e6810a}{set\_control}}(\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903a}{Control}} ctrl);}
\DoxyCodeLine{00234 }
\DoxyCodeLine{00239     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02d}{State}}}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00240}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a3087f343d739cb1cd138250ed6925eb8}{00240}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a3087f343d739cb1cd138250ed6925eb8}{get\_state}}() \{ \textcolor{keywordflow}{return} m\_parameters[\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7ad4d184bb0cd942f6bdd5ae4435ba1469}{\_DCOMstatus}}]-\/>get<\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02d}{State}}>(); \};}
\DoxyCodeLine{00241 }
\DoxyCodeLine{00247     \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00248}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a6d875fd4488248671fb060c6a73030e2}{00248}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a6d875fd4488248671fb060c6a73030e2}{wait\_state}}(\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02d}{State}} state, uint16\_t \_mask = \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dac8ab6913526ea2fc62be30139261fbc6}{mask}}) \{}
\DoxyCodeLine{00249         \textcolor{keywordflow}{while}((\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a3087f343d739cb1cd138250ed6925eb8}{get\_state}}() \& \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dac8ab6913526ea2fc62be30139261fbc6}{mask}}) != (state \& \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a16a451fc3593c0f174911e969a7be02dac8ab6913526ea2fc62be30139261fbc6}{mask}}))}
\DoxyCodeLine{00250             ;}
\DoxyCodeLine{00251     \}; \textcolor{comment}{//std::cout << (get\_state()\&mask) << " " << (state\&mask)<< "\(\backslash\)n";\}}}
\DoxyCodeLine{00252 }
\DoxyCodeLine{00258     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00259     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a7e215f070766749f80655042cf70b6c2}{set\_mode}}(\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3ceb}{OperationMode}} mode, \textcolor{keywordtype}{bool} wait = \textcolor{keyword}{false});}
\DoxyCodeLine{00260 }
\DoxyCodeLine{00266     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a47ce7e20890160451d8b43b4e32d3ceb}{OperationMode}}}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00267}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a0ece511729874fd45f24f5c517d84eae}{00267}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a0ece511729874fd45f24f5c517d84eae}{get\_mode}}(\textcolor{keywordtype}{bool} force\_sdo = \textcolor{keyword}{true}) \{ \textcolor{keywordflow}{return} this-\/>get<OperationMode>(\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a27c60a5c7499691fa7a8927c3d4e4376}{\_DCOMopmd\_act}}, force\_sdo); \};}
\DoxyCodeLine{00268 }
\DoxyCodeLine{00275     \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00276     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a20967f674c7bfa52407350933248a300}{set\_position}}(int32\_t target, \textcolor{keywordtype}{bool} absolute = \textcolor{keyword}{true});}
\DoxyCodeLine{00282     \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00283     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a7a249fdda103c6c8d11e840d66514137}{set\_velocity}}(int32\_t target);}
\DoxyCodeLine{00289     \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00290     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a4b97e1e92f96eb579a85a4d33ef0592a}{set\_torque}}(int16\_t target);}
\DoxyCodeLine{00291 }
\DoxyCodeLine{00296     int32\_t}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00297}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a80f9eac00de5ae6c07d6d4fd56a3b110}{00297}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a80f9eac00de5ae6c07d6d4fd56a3b110}{get\_position}}() \{ \textcolor{keywordflow}{return} m\_parameters[\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7af361a27c780c9ab4fe29763c80456258}{\_p\_act}}]-\/>get<int32\_t>() -\/ m\_offset\_pos; \};}
\DoxyCodeLine{00302     int32\_t}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00303}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a0345a38f5dc54e5bcacd8cc86f6b903a}{00303}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a0345a38f5dc54e5bcacd8cc86f6b903a}{get\_velocity}}() \{ \textcolor{keywordflow}{return} m\_parameters[\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a5790a9abb07781ba9d63ed64d7e0d7fc}{\_v\_act}}]-\/>get<int32\_t>(); \};}
\DoxyCodeLine{00308     int32\_t}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00309}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a32a2469e5958bf328b7df6ad7b7d49c1}{00309}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a32a2469e5958bf328b7df6ad7b7d49c1}{get\_torque}}() \{ \textcolor{keywordflow}{return} m\_parameters[\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7a0ab750decb5de6f5b2d380776dec09cc}{\_tq\_act}}]-\/>get<int32\_t>(); \};}
\DoxyCodeLine{00310 }
\DoxyCodeLine{00315     \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00316}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9f5910067bb7489887a9ed25ba6199f8}{00316}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9f5910067bb7489887a9ed25ba6199f8}{set\_position\_offset}}(int32\_t offset\_pos) \{ m\_offset\_pos = offset\_pos; \};}
\DoxyCodeLine{00317 }
\DoxyCodeLine{00321     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00322     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_ad8ac07202c14ad344004146e126ecbf4}{start}}();}
\DoxyCodeLine{00326     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00327     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a05da9b5bdd80efed46b0629721d0664b}{pause}}();}
\DoxyCodeLine{00331     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00332     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_abd7d88699d02c007d5f23e608d8f0a0a}{stop}}();}
\DoxyCodeLine{00333 }
\DoxyCodeLine{00337     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00338     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_aa94db47b419a6afcc409c63c2685e1b6}{profilePosition\_mode}}();}
\DoxyCodeLine{00342     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00343     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a32db059a1723f5c8db8986324ce21f8f}{profileVelocity\_mode}}();}
\DoxyCodeLine{00347     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00348     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a4f2bd3e58752dfd0bc37b749452ebcfd}{profileTorque\_mode}}();}
\DoxyCodeLine{00352     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00353     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a2fe863ef0d5d66f3241eda596a507377}{homing}}();}
\DoxyCodeLine{00354 }
\DoxyCodeLine{00355     \mbox{\hyperlink{struct_c_a_nopen_1_1_parameter}{Parameter}} *}
\DoxyCodeLine{00356     get\_param(\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a9504ce08c5bec248880fe4e6803565f7}{Register}} reg) \{ \textcolor{keywordflow}{return} m\_parameters[reg]; \};}
\DoxyCodeLine{00357 }
\DoxyCodeLine{00358     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}}
\DoxyCodeLine{00359     print\_manufacturer\_status() = 0;}
\DoxyCodeLine{00360 }
\DoxyCodeLine{00361     std::string}
\DoxyCodeLine{00362     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a05fb7b074555086b45918179c64494a6}{ctrl\_to\_str}}(\mbox{\hyperlink{class_c_a_nopen_1_1_driver_af4031601d8ef94250316995e8339903a}{Control}} control);}
\DoxyCodeLine{00363 }
\DoxyCodeLine{00367     \textcolor{keywordtype}{bool}}
\DoxyCodeLine{\Hypertarget{_c_a_nopen__driver_8h_source_l00368}\mbox{\hyperlink{class_c_a_nopen_1_1_driver_a249f11262c9264cf53486c247d004b99}{00368}}     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a249f11262c9264cf53486c247d004b99}{is\_available}}() \{ \textcolor{keywordflow}{return} m\_available; \};}
\DoxyCodeLine{00369 }
\DoxyCodeLine{00370     \textcolor{keyword}{protected}:}
\DoxyCodeLine{00375     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00376     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_ad22705c4ee8cfee391113d359e790e67}{send}}(\mbox{\hyperlink{struct_c_a_nopen_1_1_parameter}{Parameter}} *param);}
\DoxyCodeLine{00377 }
\DoxyCodeLine{00382     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00383     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a96123f2965334f4fda9c01ae7b0f8f46}{update}}(\mbox{\hyperlink{struct_c_a_nopen_1_1_parameter}{Parameter}} *param);}
\DoxyCodeLine{00384 }
\DoxyCodeLine{00391     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00392     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_abd3e2b466b31e906ae7bcb390277f3dd}{map\_PDO}}(PDOFunctionCode fn, \mbox{\hyperlink{struct_c_a_nopen_1_1_parameter}{Parameter}} *param, \textcolor{keywordtype}{int} slot);}
\DoxyCodeLine{00393 }
\DoxyCodeLine{00399     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00400     \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a6cfa4f397be17e661e93bfb8f74ddb90}{activate\_PDO}}(PDOFunctionCode fn, \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_c_a_nopen_1_1_driver_a0da074f8cf3498e5d1c721ceaaa81a6e}{set}} = \textcolor{keyword}{true});}
\DoxyCodeLine{00401 }
\DoxyCodeLine{00402     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00403     T\_socket();}
\DoxyCodeLine{00404 }
\DoxyCodeLine{00405     \textcolor{keywordtype}{void}}
\DoxyCodeLine{00406     RPDO\_socket();}
\DoxyCodeLine{00407 }
\DoxyCodeLine{00408     std::thread *m\_rpdo\_socket\_thread;}
\DoxyCodeLine{00409     std::atomic\_flag rpdo\_socket\_flag;}
\DoxyCodeLine{00410     std::mutex rpdo\_mutex;}
\DoxyCodeLine{00411     std::thread *m\_t\_socket\_thread;}
\DoxyCodeLine{00412     std::atomic\_flag t\_socket\_flag;}
\DoxyCodeLine{00413 }
\DoxyCodeLine{00414     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *m\_ifname;}
\DoxyCodeLine{00415     \textcolor{keywordtype}{int} m\_verbose\_level;}
\DoxyCodeLine{00416     \textcolor{keywordtype}{bool} m\_available;}
\DoxyCodeLine{00417 }
\DoxyCodeLine{00418     \mbox{\hyperlink{class_c_a_nopen_1_1_socket}{CANopen::Socket}} m\_socket;}
\DoxyCodeLine{00419 }
\DoxyCodeLine{00420     std::map<PDOFunctionCode, std::vector<Parameter *>> m\_PDO\_map;}
\DoxyCodeLine{00421     std::map<Register, Parameter *> m\_parameters;}
\DoxyCodeLine{00422 }
\DoxyCodeLine{00423     uint8\_t m\_node\_id;}
\DoxyCodeLine{00424     uint16\_t m\_can\_baud;}
\DoxyCodeLine{00425     int32\_t m\_offset\_pos = 0;}
\DoxyCodeLine{00426 \};}
\DoxyCodeLine{00427 }
\DoxyCodeLine{00428 \} \textcolor{comment}{// namespace CANopen}}
\DoxyCodeLine{00429 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
